function [] = psyLogFit(results, stimType)

switch stimType
    case 'ainicial'
        stim = results(:,4);
        r = 4;
    case 'arotacion'
        stim = results(:,1);
        r = 1;
    case 'afinal'
        stim = results(:,1) + results(:,4);
    case 'velocidad'
        results(:,9) = results(:,9).*sign(results(:,1));
        stim = results(:,9);
        r = 9;
    case 'tiempo'
        results(:,8) = results(:,8).*sign(results(:,1));
        stim = results(:,8);
        r = 8;
end

stimLevels = unique(stim);
numResp = zeros(size(stimLevels));
n = numResp;
for i = 1:length(stimLevels)
   resp = results(results(:,r) == stimLevels(i), 2);
   numResp(i) = sum(resp == 1);
   n(i) = length(resp);


b = glmfit(stimLevels, [numResp, n], 'binomial', 'link', 'probit');
yfit = glmval(b,stimLevels, 'probit', 'size', n);
plot(stimLevels, numResp./n, 'ok',stimLevels, yfit./n)
end

